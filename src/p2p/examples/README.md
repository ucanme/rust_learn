# P2P 示例程序使用说明

本目录包含了P2P客户端和服务端的示例程序，用于演示如何使用p2p库进行点对点通信。

## 示例程序说明

### 服务端示例 (server.rs)
服务端示例程序演示了如何创建并启动P2P服务端，监听客户端连接请求。

### 客户端示例 (client.rs)
客户端示例程序演示了如何创建P2P客户端，连接到服务端，并提供了一个简单的命令行界面用于模拟消息发送。

## 使用方法

**注意：目前p2p库本身存在编译错误，这些示例程序可能无法正常运行。需要先修复库中的错误。**

### 修复编译错误
p2p库目前存在多个编译错误，主要集中在以下几个方面：

1. server.rs中存在多处可变/不可变借用冲突
2. 未使用的变量警告
3. 其他语法和类型错误

需要先修复这些错误，然后才能正常编译和运行示例程序。

### 运行示例（修复错误后）

1. 首先启动服务端：
```
cd /Users/ji.wu/RustroverProjects/learn/src/p2p
cargo run --example server
```

2. 然后在另一个终端中启动客户端：
```
cd /Users/ji.wu/RustroverProjects/learn/src/p2p
cargo run --example client
```

3. 客户端启动后，会提示输入用户ID，然后连接到服务端

4. 连接成功后，可以输入消息进行广播，或使用 `/msg <user_id> <message>` 格式发送私聊消息

5. 输入 `/exit` 退出客户端

## 开发说明

1. 我们已经在p2p/src/lib.rs中导出了client、server和common模块，使示例程序能够正确导入这些模块

2. 我们还为P2PError实现了From<std::io::Error>和std::error::Error特性，使错误处理更加方便

3. 客户端示例程序中，由于库的限制，目前只模拟了消息发送过程，实际的消息发送功能需要根据p2p库的具体API进行实现

## 待办事项

1. 修复p2p库中的编译错误
2. 完善客户端示例中的消息发送功能
3. 添加更多高级功能示例，如文件传输、安全认证等